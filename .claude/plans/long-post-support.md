# 長文投稿対応計画

## 概要

mypaceで長文投稿をサポートしつつ、他のNostrクライアントのユーザーに迷惑をかけない設計。

## 背景

- Nostrには短文用(Kind 1)と長文用(Kind 30023)がある
- Kind 30023は対応クライアントが少なく、読者が限られる
- mypaceは長文推奨だが、Kind 1ユーザーに嫌われたくない

## 方針

### 1. 投稿時（Kind 1 + foldタグ）

長文もKind 1として投稿するが、mypace独自のfoldタグを使用:

```json
{
  "kind": 1,
  "content": "これは冒頭の文章です。ここまでが他のクライアントに見える部分。\n\n続きはmypaceで → https://mypace.example.com/post/{id}",
  "tags": [
    ["t", "mypace"],
    ["mypace", "fold", "…ここからはmypaceでのみ表示される続きの本文。"]
  ]
}
```

**メリット:**
- 他のクライアントには短いプレビュー + mypaceへのリンクが見える
- SNSの膨大なユーザーにリーチできる
- mypaceユーザーは全文を楽しめる
- mypaceへの誘導もできる

### 2. 表示時（Kind 1 + Kind 30023混在）

タイムラインでKind 1とKind 30023の両方を取得して混在表示:

- Kind 1: 通常の短文投稿 + mypaceの長文投稿（foldタグ付き）
- Kind 30023: 他のブログクライアントからの長文記事

**表示ルール:**
- foldタグがある投稿: プレビュー + 「READ MORE」ボタン
- Kind 30023: 記事アイコン + タイトル + プレビュー
- 通常のKind 1: そのまま表示（既存の切り詰めロジック）

### 3. 閾値

- プレビュー文字数: 280文字（Twitter風）または500文字
- それ以上はfoldタグに格納

## 実装タスク

### Phase 1: 表示対応
- [ ] Kind 30023の取得をAPIに追加
- [ ] タイムラインでKind 1とKind 30023を混在表示
- [ ] Kind 30023用のカード表示（タイトル、要約）
- [ ] foldタグの検出と展開表示

### Phase 2: 投稿対応
- [ ] 長文投稿時にfoldタグを生成
- [ ] プレビュー末尾にmypaceリンクを追加
- [ ] 閾値の設定（ユーザー設定可能にするか固定か）

### Phase 3: UX改善
- [ ] 長文プレビューのスタイリング
- [ ] Kind 30023記事の区別表示（アイコン等）
- [ ] 投稿フォームでの文字数表示・警告

## 参考: Nostr Kind番号

| Kind | 用途 | 特徴 |
|------|------|------|
| 1 | 短文ノート | 編集不可、全クライアント対応 |
| 30023 | 長文記事 | 編集可能、対応クライアント少 |

## SNSとブログの橋渡しについて

### ブログ作者の視点

mypaceがKind 30023（ブログ記事）を表示し、SNSユーザーがスターやコメントを付けられるようにすることについて:

**歓迎される理由:**
- 予想外の読者からの反応は励みになる
- リーチが広がる = 書いた甲斐がある
- SNSでバズれば新規読者獲得のチャンス
- Nostrの思想「オープンなプロトコル」に合致
- 閉じたブログプラットフォームより開かれている

**懸念点:**
- 記事を読まずに表面的なコメントが来る可能性
- 文脈を理解しない批判
- ただしこれはNostr全体の特性（誰でも誰にでも返信可能）

**結論:**
- 基本的に歓迎されると考えられる
- 「SNSとブログの橋渡し」はNostrの強みを活かす形
- mypaceがその役割を担うことに価値がある

## 注意点

- foldタグはmypace独自仕様（他クライアントは無視）
- リンクのドメインはデプロイ先に合わせる
- 将来的にfoldタグが他のクライアントでも採用される可能性を考慮した設計に
