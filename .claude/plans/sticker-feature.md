# シール機能計画

## 概要

投稿の上に自由配置できる画像「シール」機能。
LINEのスタンプ文化のように、mypace独自のシール文化を作る。

## コンセプト

- 投稿カードの上に**絶対配置**で画像を重ねる
- 左上からの相対位置（%）で指定
- 投稿の右側の空白活用、または文字に重ねる
- ヴィレバン的な安っぽいPOP感
- Zapでシールを売買できる経済圏

## 表示イメージ

### 空白活用パターン
```
┌──────────────────────────────────┐
│ こんにちは、今日は             ┌──────┐
│ いい天気ですね。               │100円 │
│                                │引き！│
│ 散歩に行ってきました。         └──────┘
│
│ [通常の画像]                   ┌────┐
│                                │注目│
│ また明日。                     └────┘
└──────────────────────────────────┘
```

### 文字に重ねるパターン
```
┌──────────────────────────────────┐
│ こんにちは、今日は                │
│ いい天気┌────┐ね。               │
│         │SALE│                   │
│ 散歩に行└────┘きました。         │
│                                   │
└──────────────────────────────────┘
```

### 複数シール
```
┌──────────────────────────────────┐
│ ┌───┐                            │
│ │NEW│ 新商品のお知らせ           │
│ └───┘                     ┌────┐ │
│ 詳しくはこちら...         │限定│ │
│                           └────┘ │
└──────────────────────────────────┘
```

## タグ形式

既存の拡張タグ（stella, teaser, aurora）と同様のシンプルな形式:

```json
["sticker", "<url>", "<x>", "<y>", "<size>"]
```

- url: シール画像のURL
- x: 左からの位置（%、0-100）
- y: 上からの位置（%、0-100）
- size: 幅（%、5-50推奨）

## イベント形式

Kind 1に`sticker`タグを追加:

```json
{
  "kind": 1,
  "content": "新商品のお知らせ\n詳しくはこちら...",
  "tags": [
    ["t", "mypace"],
    ["client", "mypace"],
    ["sticker", "https://nostr.build/i/new-label.png", "5", "5", "15"],
    ["sticker", "https://nostr.build/i/sale-pop.png", "85", "10", "20"]
  ]
}
```

## サンプルシール画像

nostr.buildにアップロードするサンプルPOP画像:

1. **NEW** - 赤い斜めバッジ
2. **SALE** - 黄色の爆発マーク  
3. **限定** - 青い四角
4. **注目** - オレンジの矢印
5. **100円引き** - 緑の値札風

## 実装

### CSS
```css
.post-card {
  position: relative; /* シールの基準点 */
}

.sticker {
  position: absolute;
  pointer-events: none; /* 下の要素をクリック可能に */
  z-index: 10;
}

/* 例: x=85%, y=10%, size=20% */
.sticker[data-x="85"][data-y="10"] {
  left: 85%;
  top: 10%;
  width: 20%;
}
```

### JavaScript
```typescript
function parseStickers(tags: string[][]): Sticker[] {
  return tags
    .filter(t => t[0] === 'mypace' && t[1] === 'sticker')
    .map(t => ({
      url: t[2],
      x: parseInt(t[3], 10),
      y: parseInt(t[4], 10),
      size: parseInt(t[5], 10),
    }))
}
```

### React コンポーネント
```tsx
function PostStickers({ stickers }: { stickers: Sticker[] }) {
  return (
    <>
      {stickers.map((s, i) => (
        <img
          key={i}
          src={s.url}
          className="sticker"
          style={{
            left: `${s.x}%`,
            top: `${s.y}%`,
            width: `${s.size}%`,
          }}
        />
      ))}
    </>
  )
}
```

## シールエディタUI

### アイコンデザイン

ジョジョ6部「キッス」のシールをオマージュ:
- 四角いシール形状
- 唇マーク（リップ）
- ツールチップ: 「シールを貼る」

```
┌─────┐
│ 💋  │  ← キッス風シールアイコン
└─────┘
```

### 投稿フォームに追加
1. 「シールを貼る」ボタン（キッスアイコン）
2. シール選択モーダル（自分のシール一覧）
3. プレビュー上でドラッグして位置決め
4. サイズ調整スライダー

### シール配置フロー
```
1. シール画像を選択（アップロード or ライブラリ）
2. プレビュー上でドラッグ＆ドロップ
3. 位置・サイズを調整
4. 確定 → タグに変換
```

## サンプルシールの種類

### 汎用POP系
- 「NEW」「SALE」「限定」「注目」
- 「100円引き」「半額」「お得」
- 「おすすめ」「人気」「急上昇」

### リアクション系
- 「いいね」「最高」「草」
- 「泣ける」「感動」「神」
- 「ツッコミ」「なんでやねん」

### 装飾系
- キラキラエフェクト
- 矢印・吹き出し
- フレーム・枠

## 他クライアントでの表示

シールタグを理解しないクライアントでは:
- 本文のみ表示（シールは無視される）
- 構文 `[sticker:...]` を本文に残す場合はそのまま表示

## 実装ステップ

### Phase 1: サンプル作成と基本表示
1. サンプルPOP画像を5種類作成（NEW, SALE, 限定, 注目, 100円引き）
2. nostr.buildにアップロード
3. テスト用のイベントを手動で作成
4. タグからシール描画する表示機能を実装

### Phase 2: 投稿UI
5. 投稿フォームに「シールを貼る」ボタン追加（💋アイコン）
6. シールライブラリUI（サンプル5種から選択）
7. プレビュー上でシール配置（位置・サイズ調整）
8. 投稿時にタグ生成

### Phase 3: 拡張（将来）
9. カスタムシールのアップロード
10. シールコレクションの共有

## 注意点

- シール画像も nostr.build 経由（削除不可）
- 過度なシールはうざい → 枚数制限を検討
- モバイルでの配置操作UX
- パフォーマンス（多数のシール描画）
