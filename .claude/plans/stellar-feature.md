# ステラ機能計画

## 概要

はてなスターをオマージュした「ステラ」機能。
Nostr Zapと連携したカラーステラの経済圏を構築。

## 設計思想

### 承認欲求モンスターを作らない

**問題意識:**
- SNSは「いいね」欲しさにユーザーを暴走させる
- 過激な投稿、炎上商法、承認欲求の奴隷化
- 認められたいのは人間の本能。それ自体は悪くない

**mypaceのアプローチ:**
- 認められるハードルを**極限まで下げる**
- 簡単にステラがつく雰囲気を作る
- **インフレを意図的に起こす**
- どの投稿にも★が1個ついて当たり前の世界

### インフレの設計

```
従来のSNS:
  いいね0 → 普通
  いいね10 → すごい！
  いいね100 → バズった！
  → いいねが欲しくて過激化

mypace:
  ★0 → ほぼない（みんな気軽に付ける）
  ★10 → 普通
  ★100 → 普通
  → ステラは空気のように付くもの
  → 欲しがる必要がない
```

### カラーステラがイエローの障壁を下げる

- カラーステラ（有料・レア）があることで
- イエロー（無料）の価値が相対的に「軽く」なる
- 「無料だし、とりあえず付けておこう」心理
- **気軽に付ける文化**が生まれる

### はてブのスター集めゲーム

- 承認欲求を満たすゲームではない
- **収集ゲーム**として楽しむ
- コレクション要素
- 「紫ステラ持ってる！」という自慢
- ゲーミフィケーションを健全に使う

### GIVERが偉い文化

**Xへのアンチテーゼ:**
```
X/Twitter:
  フォロワー > フォロー = かっこいい
  いいね貰う数が多い = 偉い
  → TAKE文化

mypace:
  あげた数 > もらった数 = かっこいい
  ステラ付与数が多い = 偉い
  → GIVE文化
```

**価値観の転換:**
- 「もらった数」は自慢にならない
- 「あげた数」が多い人が尊敬される
- SUPER GIVER が最高位
- TAKER は恥ずかしい（わけではないが、GIVERが輝く）

**設計の意図:**
- 承認を「もらう」ことに価値を置かない
- 承認を「あげる」行為に価値を置く
- コミュニティ全体が温かくなる
- 「俺はこんなにステラ配った」という健全な自慢

## 基本概念

### イエローステラ（無料）
- 誰でも無制限に付けられる
- 「いいね」相当
- コストなし

### カラーステラ（有料）
- Zapで購入
- 他のユーザーに投げられる
- 受け取ったユーザーはそのカラーを使える
- **使っても投稿から消えない**（付けた記録は残り続ける）
- **Zap購入なしでも使える**（もらったカラーを使用）

## 冠位十二階に基づくカラー階級

| 階級 | 色 | 徳目 | Zap (sats) |
|------|-----|------|-----------|
| 大徳 | 紫 (むらさき) | 徳 | 10,000 |
| 小徳 | 薄紫 | 徳 | 5,000 |
| 大義 | 青 (あお) | 義 | 2,000 |
| 小義 | 薄青 | 義 | 1,000 |
| 大信 | 白 (しろ) | 信 | 500 |
| 小信 | 灰白 | 信 | 250 |
| 大礼 | 黄 (き) | 礼 | 100 |
| 小礼 | 薄黄 | 礼 | 50 |
| 大仁 | 赤 (あか) | 仁 | 20 |
| 小仁 | 薄赤 | 仁 | 10 |
| 大智 | 黒 (くろ) | 智 | 5 |
| 小智 | 灰 | 智 | 1 |
| - | 黄 | - | 無料 |

## 表示イメージ

### 投稿のステラ表示

```
┌─ 投稿 ─────────────────────────────────┐
│ @username                              │
│                                        │
│ 今日のランチ美味しかった！              │
│                                        │
│ ★★★★★☆☆☆ ●●● ◆◆ ▲           │
│ (黄x5)  (赤x3) (青x2) (紫x1)           │
└────────────────────────────────────────┘
```

### ステラ詳細ポップアップ

```
┌─ ステラ詳細 ─────────────────────────┐
│                                      │
│ ★ イエローステラ x 5                 │
│   @user1, @user2, @user3...          │
│                                      │
│ ● 大仁（赤）x 3                      │
│   @user4 (20 sats)                   │
│   @user5 (20 sats)                   │
│   @user6 (20 sats)                   │
│                                      │
│ ◆ 大義（青）x 2                      │
│   @user7 (2,000 sats)                │
│   @user8 (2,000 sats)                │
│                                      │
│ ▲ 大徳（紫）x 1                      │
│   @user9 (10,000 sats)               │
│                                      │
└──────────────────────────────────────┘
```

## ステラの所有と使用

### 所有ステラの管理

```
┌─ マイステラ ─────────────────────────┐
│                                      │
│ 所有カラーステラ:                     │
│                                      │
│ ● 赤 (大仁): 3個                     │
│   └─ @userAからもらった              │
│   └─ @userBからもらった              │
│   └─ @userCからもらった              │
│                                      │
│ ◆ 青 (大義): 1個                     │
│   └─ @userDからもらった              │
│                                      │
│ 紫は持っていません                    │
│                                      │
│ [Zapでステラを購入]                   │
└──────────────────────────────────────┘
```

### 使用フロー

1. 投稿にステラを付けたい
2. ステラ選択UI表示
3. 黄（無料）or 所有カラーを選択
4. 投稿に付与

```
┌─ ステラを付ける ─────────────────────┐
│                                      │
│ [★ 黄] 無料・無制限                   │
│                                      │
│ [● 赤] 大仁 (所有: 3個)               │
│ [◆ 青] 大義 (所有: 1個)               │
│ [▲ 紫] 大徳 (所有: 0個) ← 灰色       │
│                                      │
│ [💰 Zapで購入して付ける]              │
│                                      │
└──────────────────────────────────────┘
```

## データ構造

### ステライベント（案）

```json
{
  "kind": 7,  // リアクション
  "content": "★",  // または色別記号
  "tags": [
    ["e", "<post_id>"],
    ["p", "<author_pubkey>"],
    ["mypace", "stellar", "purple", "10000"]
  ]
}
```

### ステラ所有の記録

カラーステラを受け取った記録 = 使用権の証明

```json
{
  "kind": 7,
  "tags": [
    ["e", "<my_post_id>"],
    ["p", "<my_pubkey>"],
    ["mypace", "stellar", "red", "20"]
  ]
}
```
→ この投稿主は「赤ステラ」を使える

## Zap連携

### 購入フロー

```
1. ユーザーがカラーステラを選択
2. Zap金額を計算（紫=10,000 sats等）
3. Lightning Invoice生成
4. 支払い完了
5. ステライベント発行
6. 受信者のステラ所有に追加
```

### Zapイベントとの紐付け

```json
{
  "kind": 9735,  // Zap Receipt
  "tags": [
    ["bolt11", "<invoice>"],
    ["description", "{...zap request with stellar info...}"],
    ["mypace", "stellar", "purple"]
  ]
}
```

## UI実装

### ステラボタン

現在の「いいね」ボタンを拡張:

```
[★ 5] [● 3] [◆ 2] [▲ 1]   [+ステラ]
                              ↑
                         クリックで選択UI
```

### ステラ付与アニメーション

- 黄: シンプルに追加
- カラー: キラキラエフェクト + sats表示
- 紫: 特別な演出（冠が降ってくる等）

## 実装優先度

1. イエローステラ（現在のいいねを変更）
2. ステラカウント表示
3. カラーステラ表示
4. Zap購入フロー
5. 所有ステラ管理
6. 所有ステラの使用

## はてなスターとの違い

| 機能 | はてな | mypace |
|------|--------|--------|
| 無料スター | 黄のみ | 黄のみ |
| 有料スター | 課金 | Zap (Lightning) |
| 色の意味 | 希少性 | 冠位十二階 |
| もらったスター | 使えない | 使える |
| 分散型 | ✗ | ✓ |

## Zapの行き先について

### 考えられるパターン

| パターン | 行き先 | メリット | デメリット |
|----------|--------|----------|------------|
| A | 投稿者 | 標準的、クリエイター報酬 | ゲーム性薄い |
| B | mypace運営 | 運営費に | 中央集権的 |
| C | バーン（消滅） | 純粋なゲーム通貨 | satsが無駄に |
| D | プール → 再配布 | 循環経済 | 実装複雑 |

### 推奨: パターンA + 自己購入可能

- ステラを付けると → 投稿者にZapが行く
- **自分で自分に付けられる**（自己購入）
  - 自分の投稿に自分でカラーステラを付ける
  - 実質的に「ステラをミント」する行為
  - satsは自分に戻る（手数料程度のロス）
- 金額よりもゲーム性・レア感が目的

### 自己購入のUX

```
┌─ ステラを購入 ─────────────────────────┐
│                                        │
│ 自分の投稿にカラーステラを付けて        │
│ そのカラーを獲得できます                │
│                                        │
│ [● 赤 (大仁)] 20 sats                  │
│ [◆ 青 (大義)] 2,000 sats               │
│ [▲ 紫 (大徳)] 10,000 sats              │
│                                        │
│ ※ Zapは自分自身に送られます            │
│                                        │
└────────────────────────────────────────┘
```

## プロフィールのステラ統計

### キルレシオ風の表示

FPSゲームのK/D比のように、あげた数ともらった数を表示。

```
┌─ ステラ統計 ─────────────────────────┐
│                                      │
│  もらった ★ 1,234    あげた ★ 5,678  │
│                                      │
│        GIVE/TAKE RATIO               │
│            4.60                      │
│         ████████░░                   │
│          GIVER型                     │
│                                      │
│  ─────────────────────────────────   │
│                                      │
│  カラー内訳:                          │
│  ● 赤: もらった 45 / あげた 120      │
│  ◆ 青: もらった 12 / あげた 34       │
│  ▲ 紫: もらった 2  / あげた 5        │
│                                      │
└──────────────────────────────────────┘
```

### ユーザータイプ判定

| Ratio | タイプ | 説明 |
|-------|--------|------|
| 0.0-0.5 | TAKER | もらう専門 |
| 0.5-0.8 | BALANCED- | やや受け身 |
| 0.8-1.2 | BALANCED | バランス型 |
| 1.2-2.0 | BALANCED+ | やや積極的 |
| 2.0-5.0 | GIVER | あげる方が多い |
| 5.0+ | SUPER GIVER | 太っ腹 |

### 面白い統計案

```
┌─ ステラ実績 ─────────────────────────┐
│                                      │
│ 📊 総合統計                           │
│                                      │
│ ★ 総獲得: 1,234                      │
│ ★ 総付与: 5,678                      │
│ 📈 G/T比: 4.60 (SUPER GIVER)         │
│                                      │
│ 🏆 実績                              │
│ ・最も付けた相手: @friend (234個)    │
│ ・最も貰った相手: @mentor (156個)    │
│ ・1日最多付与: 89個 (2025/03/15)     │
│ ・連続付与日数: 42日                 │
│                                      │
│ 💎 カラーステラ                       │
│ ・紫を付けた回数: 5回                │
│ ・紫をもらった回数: 2回              │
│ ・最高額ステラ: 紫 (10,000 sats)     │
│                                      │
└──────────────────────────────────────┘
```

### ランキング要素

- GIVER ランキング（最も多くあげた人）
- 紫ステラ保有者ランキング
- 連続付与日数ランキング

## 画面右下のステラ実績表示

Roblox BrainRot風の大きな数字表示。

### 表示イメージ

```
                              ┌──────────────┐
                              │     ★        │
                              │   2.4K       │
                              │              │
                              │  ● 156       │
                              │  ◆ 23        │
                              │  ▲ 3         │
                              └──────────────┘
```

### 常時表示

- 画面右下に固定表示
- 自分が今まで獲得したステラ総数
- 大きなフォントでインパクト
- カラー別の内訳も表示

### 数字の単位

| 数 | 表示 |
|----|------|
| 1,234 | 1.2K |
| 12,345 | 12.3K |
| 123,456 | 123K |
| 1,234,567 | 1.2M |
| 1,234,567,890 | 1.2B |
| 1,234,567,890,000 | 1.2T |

### アニメーション

- 新しいステラが来たら数字がカウントアップ
- 紫ステラが来たら特別なエフェクト
- 定期的にキラキラ演出

### CSS/実装

```tsx
function StellarStats() {
  const stats = useStellarStats()  // 自分の獲得ステラ

  return (
    <div className="stellar-stats-overlay">
      <div className="stellar-total">
        <span className="stellar-icon">★</span>
        <span className="stellar-count">{formatNumber(stats.total)}</span>
      </div>
      <div className="stellar-colors">
        <div className="stellar-red">● {stats.red}</div>
        <div className="stellar-blue">◆ {stats.blue}</div>
        <div className="stellar-purple">▲ {stats.purple}</div>
      </div>
    </div>
  )
}
```

```css
.stellar-stats-overlay {
  position: fixed;
  bottom: 1rem;
  right: 1rem;
  font-family: var(--font-display);
  text-align: right;
  z-index: 100;
}

.stellar-total {
  font-size: 3rem;
  font-weight: bold;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
}

.stellar-count {
  background: linear-gradient(to bottom, #ffd700, #ffaa00);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
```

## 目的の明確化

**目的はゲームとして楽しむこと:**
- 金額は関係ない（大した額にならない）
- 無料より貴重性があって嬉しい
- みんなで遊べる
- 実績として誇れる

**mypace運営への収益ではない:**
- Zapは投稿者に行く
- 運営は手数料を取らない
- 純粋なコミュニティゲーム

## 注意点

- Zapの実装が必要（NIP-57）
- Lightning Walletとの連携
- ステラの永続性（削除不可）
- 冠位十二階の説明をユーザーに提供
