# NIP-07拡張

ブラウザ拡張で秘密鍵を安全に管理する方法です。

## NIP-07とは

NIP-07はNostrの認証規格です。対応するブラウザ拡張を使うと:

- 秘密鍵がブラウザ拡張内に安全に保管される
- ウェブサイトに秘密鍵を渡さずに署名できる
- 複数のNostrクライアントで同じアカウントを使える

## 対応拡張

| 拡張 | 説明 |
|------|------|
| nos2x | シンプルで軽量 |
| Alby | Lightning連携も可能 |
| nostr-keyx | iOS/Android対応 |

> **注意**: NIP-07拡張はPCのブラウザ向けです。スマートフォンのブラウザでは利用できません。

## 使い方

### 1. 拡張をインストール

お好みのNIP-07拡張をブラウザにインストールします。

### 2. 秘密鍵を拡張にインポート

現在MY PACEで使っている秘密鍵を拡張にインポートします。

1. MY PACEの設定から秘密鍵をコピー（先にバックアップ！）
2. 拡張の設定画面で秘密鍵をインポート

### 3. MY PACEで有効化

NIP-07拡張をインストールしただけでは使用されません。設定から明示的に有効化する必要があります。

1. 設定画面を開く
2. 「Authentication Method」セクション
3. 「NIP-07 extension」を選択
4. 確認ダイアログで「有効化」をクリック

> **重要**: NIP-07を有効化すると、ブラウザに保存されていた秘密鍵は削除されます。必ず事前に秘密鍵をバックアップしてください。

### 4. 接続を確認

有効化後、設定画面に「Connected: npub1...」と表示されれば正常に連携できています。

## 無効化（元に戻す）

NIP-07の使用をやめて、秘密鍵を直接ブラウザに保存する方式に戻すこともできます。

1. 設定画面を開く
2. 「Authentication Method」セクション
3. 「Secret key (nsec)」を選択
4. 秘密鍵を入力してインポート

## メリット

- **セキュリティ向上**: 秘密鍵がウェブサイトに渡らない
- **複数クライアント対応**: 他のNostrクライアントでも同じアカウントを使える
- **バックアップ**: 拡張が鍵を管理するので、ブラウザのlocalStorageを気にしなくて良い

## 注意点

- PCのブラウザでのみ利用可能（スマートフォンでは使えません）
- 拡張機能がインストールされていない環境では使用できません
- 署名時に拡張のポップアップが表示される場合があります

## 表示条件とデフォルト動作

### NIP-07オプションの表示

「Authentication Method」セクションでNIP-07オプションが表示されるのは、NIP-07拡張がインストールされている場合のみです。スマートフォンや拡張未インストールのPCでは、秘密鍵（nsec）方式のみが表示されます。

### デフォルトの選択

- **新規ユーザー**: 秘密鍵（nsec）がデフォルトで選択されます。NIP-07を使う場合は明示的に選択してください。
- **設定済みユーザー**: 以前選択した方式が維持されます。
- **拡張を削除した場合**: NIP-07を設定していても、拡張が検出されなくなると初回ユーザーと同じ状態に戻ります。プロフィール設定画面が表示され、新しいアイデンティティで始めるか、以前の秘密鍵をインポートして元のアカウントを復元できます。

---

[← 上級者向けに戻る](./index.md)
