# ãƒœã‚¤ã‚¹ãƒ¡ãƒ¢æ©Ÿèƒ½

æŠ•ç¨¿ã«çŸ­ã„éŸ³å£°ãƒ¡ãƒ¢ã‚’æ·»ä»˜ã§ãã‚‹æ©Ÿèƒ½ã€‚

## èƒŒæ™¯

- LINE/WhatsAppé¢¨ã®æŠ¼ã—ç¶šã‘ã¦éŒ²éŸ³
- ãƒ†ã‚­ã‚¹ãƒˆã‚’æ‰“ã¤ã®ãŒé¢å€’ãªæ™‚ã«ä¾¿åˆ©
- çŸ­ã„éŸ³å£° = æ°—è»½ã€å€‹æ€§çš„

## ä»•æ§˜

| é …ç›® | å€¤ |
|------|-----|
| æ“ä½œ | ãƒœã‚¿ãƒ³æŠ¼ã—ç¶šã‘ã§éŒ²éŸ³ã€é›¢ã™ã¨åœæ­¢ |
| æœ€å¤§æ™‚é–“ | 10ç§’ |
| å‡ºåŠ›å½¢å¼ | OGG (audio/ogg) â€»iOSéå¯¾å¿œæ™‚ã¯WebM |
| ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å…ˆ | nostr.build |
| èªè¨¼ | NIP-98 |

## UI

### éŒ²éŸ³å‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Voice Memo        00:00 / 00:10  X â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚         â”‚  æ³¢å½¢ã‚­ãƒ£ãƒ³ãƒã‚¹   â”‚         â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                     â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”                â”‚
â”‚              â”‚ ğŸ¤  â”‚                â”‚
â”‚              â”‚Hold â”‚                â”‚
â”‚              â”‚ to  â”‚                â”‚
â”‚              â”‚rec. â”‚                â”‚
â”‚              â””â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            [Cancel] [Add to Post]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éŒ²éŸ³å¾Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Voice Memo        00:07 / 00:10  X â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â–¶ â”‚   00:07   WebM Audio    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚
â”‚         [â†» Re-record]               â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            [Cancel] [Add to Post]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ“ä½œ

- **éŒ²éŸ³**: ãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ç¶šã‘ã‚‹ï¼ˆé›¢ã™ã¨åœæ­¢ï¼‰
- **å†ç”Ÿ**: â–¶ãƒœã‚¿ãƒ³ã§éŒ²éŸ³å†…å®¹ã‚’ç¢ºèª
- **å†éŒ²éŸ³**: Re-recordã§æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—
- **æŠ•ç¨¿**: Add to Postã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼†æœ¬æ–‡ã«æŒ¿å…¥

### ã‚¿ã‚¤ãƒãƒ¼å‹•ä½œ

1. éŒ²éŸ³é–‹å§‹ã¨åŒæ™‚ã«ã‚¿ã‚¤ãƒãƒ¼é–‹å§‹
2. æ®‹ã‚Š3ç§’ã§èµ¤è‰²ç‚¹æ»…
3. 10ç§’ã§è‡ªå‹•åœæ­¢

## æŠ€è¡“å®Ÿè£…

### MediaRecorder API

```typescript
const stream = await navigator.mediaDevices.getUserMedia({ audio: true })

// OGGå½¢å¼ã‚’å„ªå…ˆã€éå¯¾å¿œæ™‚ã¯WebMã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
const mimeType = MediaRecorder.isTypeSupported('audio/ogg')
  ? 'audio/ogg'
  : 'audio/webm'

const mediaRecorder = new MediaRecorder(stream, { mimeType })

mediaRecorder.start()
// ... éŒ²éŸ³ä¸­ ...
mediaRecorder.stop()

mediaRecorder.ondataavailable = (e) => {
  const blob = new Blob([e.data], { type: mimeType })
  // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å‡¦ç†
}
```

### æ³¢å½¢è¡¨ç¤º

AudioContext + AnalyserNode ã§éŒ²éŸ³ä¸­ã®æ³¢å½¢ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»:

```typescript
const audioContext = new AudioContext()
const source = audioContext.createMediaStreamSource(stream)
const analyser = audioContext.createAnalyser()
analyser.fftSize = 256
source.connect(analyser)

// Canvas ã«æ³¢å½¢ã‚’æç”»
const dataArray = new Uint8Array(analyser.frequencyBinCount)
analyser.getByteTimeDomainData(dataArray)
```

### ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

- nostr.buildã«WebMå½¢å¼ã§ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- NIP-98èªè¨¼ã‚’ä½¿ç”¨
- æœ€å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: 1MB
- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸå¾Œã€URLãŒæœ¬æ–‡ã«æŒ¿å…¥ã•ã‚Œã‚‹

## ãƒœã‚¿ãƒ³é…ç½®

æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ ã®Row2ã«é…ç½®:

```
Row2: [ã‚«ãƒ¡ãƒ©] [ã‚·ãƒ¼ãƒ«] [ãŠçµµã‹ã] [éŒ²éŸ³] [åº§æ¨™]
```

## å‰Šé™¤ã«ã¤ã„ã¦

- nostr.buildã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯å‰Šé™¤å¯èƒ½
- å‰Šé™¤ã«ã¯ [Upload History](./upload-history.md) æ©Ÿèƒ½ã‚’ä½¿ç”¨
- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å±¥æ­´ã‹ã‚‰URLã‚’ã‚³ãƒ”ãƒ¼ã—ã€nostr.buildã®å‰Šé™¤ãƒšãƒ¼ã‚¸ã§å‰Šé™¤

## ä»–ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã®è¡¨ç¤º

éŸ³å£°ã¯URLã¨ã—ã¦æŠ•ç¨¿ã•ã‚Œã‚‹ãŸã‚ã€ä»–ã®Nostrã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ã‚‚éŸ³å£°ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®å¯¾å¿œçŠ¶æ³ã«ã‚ˆã‚‹ï¼‰ã€‚

## ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œ

- MediaRecorder APIå¯¾å¿œãƒ–ãƒ©ã‚¦ã‚¶ãŒå¿…è¦
- Chrome, Firefox, Safari (14.1+), Edge ã§å‹•ä½œ
- ãƒã‚¤ã‚¯ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãŒå¿…è¦
